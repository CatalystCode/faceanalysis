version: '3'
services:
  frontend:
    build: ./frontend
    volumes:
        - "./frontend/build:/app/build"
    env_file:
      - ./environment_variables.env
  nginx:
    restart: always
    build: ./nginx
    ports:
    - "80:80"
    volumes:
      - "./persisted_data/images:/images"
      - "./frontend/build:/frontend/build"
  image_processor:
    #restart: always
    build: ./image_processor
    volumes:
      - "./persisted_data/images:/app/image_processor/images"
      - "./persisted_data/logs:/app/image_processor/logs"
    env_file:
      - ./environment_variables.env
  api:
    restart: always
    build: ./api
    ports:
      - "5000:5000"
    volumes:
      - "./persisted_data/images:/app/api/images"
      - "./persisted_data/logs:/app/api/logs"
    env_file:
      - ./environment_variables.env
  mysql:
    restart: always
    image: mysql
    volumes:
      - "./persisted_data/database:/var/lib/mysql"
    env_file:
      - ./environment_variables.env
